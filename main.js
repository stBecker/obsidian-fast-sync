/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  FileHistoryModal: () => FileHistoryModal,
  FileVersionsModal: () => FileVersionsModal,
  default: () => SimpleSyncPlugin,
  getAllFiles: () => getAllFiles,
  hashFile: () => hashFile,
  isImageFile: () => isImageFile
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var FileHistoryModal = class extends import_obsidian.FuzzySuggestModal {
  constructor(app, plugin) {
    super(app);
    this.files = [];
    this.plugin = plugin;
    this.setPlaceholder("Select a file to view history");
    this.loadFiles();
  }
  async loadFiles() {
    try {
      this.files = await this.plugin.getAllFilesFromServer();
      this.setInstructions([
        { command: "\u2191\u2193", purpose: "to navigate" },
        { command: "\u21B5", purpose: "to select" },
        { command: "esc", purpose: "to dismiss" }
      ]);
    } catch (error) {
      new import_obsidian.Notice("Failed to load files: " + error);
      this.close();
    }
  }
  getItems() {
    return this.files;
  }
  getItemText(item) {
    return item;
  }
  onChooseItem(item, evt) {
    new FileVersionsModal(this.app, this.plugin, item).open();
  }
};
var FileVersionsModal = class extends import_obsidian.Modal {
  constructor(app, plugin, fileId) {
    super(app);
    this.versions = [];
    this.plugin = plugin;
    this.fileId = fileId;
  }
  async onOpen() {
    const { contentEl } = this;
    this.contentEl = contentEl;
    contentEl.createEl("h2", { text: "Version History" });
    contentEl.createEl("p", { text: `File: ${this.fileId}` });
    const loadingEl = contentEl.createEl("p", { text: "Loading versions..." });
    try {
      this.versions = await this.plugin.getFileHistory(this.fileId);
      loadingEl.remove();
      this.displayVersions();
    } catch (error) {
      loadingEl.setText("Failed to load versions: " + error);
    }
  }
  displayVersions() {
    if (this.versions.length === 0) {
      this.contentEl.createEl("p", { text: "No history found for this file." });
      return;
    }
    const container = this.contentEl.createDiv({ cls: "history-container" });
    container.createEl("style", {
      text: `
                .history-container {
                    max-height: 400px;
                    overflow-y: auto;
                }
                .version-item {
                    border-bottom: 1px solid var(--background-modifier-border);
                    padding: 10px 0;
                    margin-bottom: 10px;
                }
                .version-header {
                    display: flex;
                    justify-content: space-between;
                    margin-bottom: 5px;
                }
                .version-content {
                    border: 1px solid var(--background-modifier-border);
                    padding: 10px;
                    margin-top: 10px;
                    max-height: 200px;
                    overflow-y: auto;
                    display: none;
                }
                .version-content.active {
                    display: block;
                }
            `
    });
    this.versions.forEach((version, index) => {
      const item = container.createDiv({ cls: "version-item" });
      const header = item.createDiv({ cls: "version-header" });
      const date = new Date(version.version_time);
      header.createEl("div", {
        text: `Version ${index + 1} - ${date.toLocaleString()}`
      });
      const buttonRow = header.createDiv();
      const toggleBtn = new import_obsidian.ButtonComponent(buttonRow).setButtonText("View").onClick(() => {
        const content2 = item.querySelector(".version-content");
        if (content2) {
          content2.classList.toggle("active");
        }
        toggleBtn.setButtonText(
          (content2 == null ? void 0 : content2.classList.contains("active")) ? "Hide" : "View"
        );
      });
      if (index > 0) {
        new import_obsidian.ButtonComponent(buttonRow).setButtonText("Restore").onClick(async () => {
          try {
            await this.restoreVersion(version);
            new import_obsidian.Notice("Version restored successfully");
            this.close();
          } catch (error) {
            new import_obsidian.Notice("Failed to restore version: " + error);
          }
        });
      }
      const content = item.createDiv({ cls: "version-content" });
      content.createEl("pre", { text: version.content });
    });
  }
  async restoreVersion(version) {
    const file = this.app.vault.getFileByPath(this.fileId);
    if (file) {
      await this.app.vault.modify(file, version.content);
    } else {
      const path = this.fileId.split("/");
      const fileName = path.pop();
      let folderPath = "";
      for (const folder of path) {
        folderPath += folder;
        const exists = this.app.vault.getAbstractFileByPath(folderPath);
        if (!exists) {
          await this.app.vault.createFolder(folderPath);
        }
        folderPath += "/";
      }
      await this.app.vault.create(this.fileId, version.content);
    }
    await this.plugin.sync();
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
async function hashFile(file) {
  const content = await file.vault.read(file);
  const msgBuffer = new TextEncoder().encode(content);
  const hashBuffer = await crypto.subtle.digest("SHA-256", msgBuffer);
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  return hashArray.map((b) => b.toString(16).padStart(2, "0")).join("");
}
async function getAllFiles(vault) {
  return vault.getAllLoadedFiles().filter((file) => file instanceof import_obsidian.TFile && (file.extension === "md" || isImageFile(file.extension)));
}
function isImageFile(extension) {
  return ["png", "jpg", "jpeg", "gif", "svg"].includes(extension.toLowerCase());
}
var DEFAULT_SETTINGS = {
  serverUrl: "",
  apiKey: "",
  syncInterval: 60,
  // in seconds
  lastSync: 0,
  deletionQueue: [],
  vaultId: "",
  fullRehashInterval: 15
  // 15 minutes default
};
var HashCache = class {
  constructor() {
    this.cache = /* @__PURE__ */ new Map();
    this.CACHE_LIFETIME = 36e5;
  }
  // 1 hour in milliseconds
  set(path, hash) {
    this.cache.set(path, {
      hash,
      timestamp: Date.now()
    });
  }
  get(path) {
    const entry = this.cache.get(path);
    if (!entry)
      return null;
    if (Date.now() - entry.timestamp > this.CACHE_LIFETIME) {
      this.cache.delete(path);
      return null;
    }
    return entry.hash;
  }
  invalidate(path) {
    this.cache.delete(path);
  }
  clear() {
    this.cache.clear();
  }
};
var SimpleSyncPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.syncPaused = false;
    this.lastFullRehash = 0;
    this.syncing = false;
  }
  async onload() {
    this.hashCache = new HashCache();
    await this.loadSettings();
    if (!this.settings.vaultId) {
      this.settings.vaultId = this.app.vault.getName();
      await this.saveSettings();
    }
    this.statusBarItemEl = this.addStatusBarItem();
    this.statusBarItemEl.setText("Last sync: Never");
    this.addSettingTab(new SimpleSyncSettingTab(this.app, this));
    this.registerEvent(this.app.vault.on("delete", this.handleFileDeletion.bind(this)));
    this.registerEvent(this.app.vault.on("rename", this.handleFileRename.bind(this)));
    this.registerEvent(
      this.app.vault.on("modify", (file) => {
        if (file instanceof import_obsidian.TFile) {
          this.hashCache.invalidate(file.path);
        }
      })
    );
    this.registerInterval(window.setInterval(() => this.sync(), this.settings.syncInterval * 1e3));
    this.addRibbonIcon("clock", "View File History", () => {
      new FileHistoryModal(this.app, this).open();
    });
    this.addCommand({
      id: "open-file-history-modal",
      name: "Open File History Browser",
      callback: () => {
        new FileHistoryModal(this.app, this).open();
      }
    });
    this.addCommand({
      id: "view-current-file-history",
      name: "View History for Current File",
      checkCallback: (checking) => {
        const activeFile = this.app.workspace.getActiveFile();
        if (activeFile) {
          if (!checking) {
            new FileVersionsModal(this.app, this, activeFile.path).open();
          }
          return true;
        }
        return false;
      }
    });
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async resync() {
    console.info("Starting resync...");
    console.info("Fetching remote state...");
    const remoteState = await this.downloadState();
    const remoteFiles = Object.keys(remoteState);
    console.info(`Found ${remoteFiles.length} files on remote`);
    console.info("Getting local files...");
    const localFiles = await getAllFiles(this.app.vault);
    console.info(`Found ${localFiles.length} files locally`);
    const remoteOnly = remoteFiles.filter((file) => !localFiles.map((file2) => file2.path).includes(file));
    console.info(`Found ${remoteOnly.length} files to delete from remote`);
    for (const fileId of remoteOnly) {
      console.debug(`Marking ${fileId} for deletion`);
      this.settings.deletionQueue.push(fileId);
    }
    await this.saveSettings();
    console.info("Preparing to upload all local files...");
    const uploads = [];
    for (const file of localFiles) {
      console.debug(`Processing ${file.path}`);
      const hash = await hashFile(file);
      uploads.push({
        fileId: file.path,
        hash,
        mtime: file.stat.mtime,
        content: await this.app.vault.read(file),
        deleted: false
      });
    }
    console.info(`Uploading ${uploads.length} files...`);
    await this.uploadChanges(uploads);
    console.info("File upload complete");
    if (this.settings.deletionQueue.length > 0) {
      console.info(`Processing ${this.settings.deletionQueue.length} deletions...`);
      await this.uploadChanges(this.settings.deletionQueue.map((fileId) => ({
        fileId,
        hash: "",
        mtime: Date.now(),
        content: "",
        deleted: true
      })));
      this.settings.deletionQueue = [];
      await this.saveSettings();
      console.info("Deletions complete");
    }
    console.info("Resync complete");
    new import_obsidian.Notice("Resync complete");
    this.statusBarItemEl.setText("Last sync: " + new Date().toLocaleTimeString());
  }
  async sync() {
    if (this.syncPaused) {
      this.statusBarItemEl.setText("Sync paused");
      return;
    }
    if (this.syncing) {
      console.info("Sync already in progress, skipping...");
      return;
    }
    this.syncing = true;
    try {
      if (Date.now() - this.lastFullRehash > this.settings.fullRehashInterval * 6e4) {
        console.info("Performing periodic full rehash...");
        this.hashCache.clear();
        this.lastFullRehash = Date.now();
      }
      this.statusBarItemEl.setText("Syncing...");
      console.info("Syncing...");
      const files = await getAllFiles(this.app.vault);
      console.info("Number of files:", files.length);
      console.debug("Files:", files.map((file) => file.path));
      console.debug("Deletion queue:", this.settings.deletionQueue);
      if (this.settings.deletionQueue.length > 0) {
        await this.uploadChanges(this.settings.deletionQueue.map((fileId) => ({
          fileId,
          hash: "",
          mtime: Date.now(),
          content: "",
          deleted: true
        })));
        this.settings.deletionQueue = [];
        await this.saveSettings();
      }
      console.info("Downloading remote changes...");
      const remoteChanges = await this.downloadState();
      const toUpload = [];
      const toDownload = [];
      console.info("Checking for changes...");
      const checkStart = performance.now();
      for (const file of files) {
        let hash = this.hashCache.get(file.path);
        if (!hash) {
          hash = await hashFile(file);
          this.hashCache.set(file.path, hash);
        }
        const remoteFile = remoteChanges[file.path];
        if (!remoteFile) {
          toUpload.push({
            fileId: file.path,
            hash,
            mtime: file.stat.mtime,
            content: await this.app.vault.read(file),
            deleted: false
          });
        } else if (remoteFile.hash !== hash) {
          hash = await hashFile(file);
          this.hashCache.set(file.path, hash);
          if (remoteFile.hash !== hash) {
            if (remoteFile.mtime > file.stat.mtime) {
              toDownload.push(file.path);
            } else {
              toUpload.push({
                fileId: file.path,
                hash,
                mtime: file.stat.mtime,
                content: await this.app.vault.read(file),
                deleted: false
              });
            }
          }
        }
      }
      const totalCheckTime = performance.now() - checkStart;
      console.info(`Change detection completed in ${totalCheckTime.toFixed(2)}ms`);
      console.info("Found local changes:", toUpload.length, "remote changes:", toDownload.length);
      console.info("Checking for remote-only files...");
      const remoteFiles = Object.keys(remoteChanges);
      const localFiles = files.map((file) => file.path);
      const remoteOnly = remoteFiles.filter((file) => !localFiles.includes(file));
      for (const fileId of remoteOnly) {
        const remoteFile = remoteChanges[fileId];
        if (!remoteFile.deleted) {
          toDownload.push(fileId);
        }
      }
      console.info("Uploading changes:", toUpload.length);
      if (toUpload.length > 0) {
        await this.uploadChanges(toUpload);
      }
      console.info("Downloading remote files:", toDownload.length);
      if (toDownload.length > 0) {
        const remoteFiles2 = await this.downloadFiles(toDownload);
        console.debug(remoteFiles2);
        console.info("Processing remote files...");
        for (const file of remoteFiles2) {
          if (file.deleted) {
            console.info("Deleting file:", file.fileId);
            const localFile = this.app.vault.getFileByPath(file.fileId);
            if (localFile) {
              await this.app.vault.delete(localFile);
            }
          } else {
            const localFile = this.app.vault.getFileByPath(file.fileId);
            if (!localFile) {
              console.info("Creating file:", file.fileId);
              const path = file.fileId.split("/");
              let folderPath = "";
              for (let i = 0; i < path.length - 1; i++) {
                folderPath += path[i];
                const folder = this.app.vault.getFileByPath(folderPath);
                if (!folder) {
                  console.info("Creating folder:", folderPath);
                  await this.app.vault.createFolder(folderPath);
                }
                folderPath += "/";
              }
              await this.app.vault.create(file.fileId, file.content);
            } else {
              console.info("Updating file:", file.fileId);
              await this.app.vault.modify(localFile, file.content);
            }
          }
        }
      }
      this.settings.lastSync = Date.now();
      await this.saveSettings();
      console.info("Sync complete");
      this.statusBarItemEl.setText("Last sync: " + new Date().toLocaleTimeString());
    } catch (error) {
      this.statusBarItemEl.setText("Sync failed");
      console.error("Sync error:", error);
    } finally {
      this.syncing = false;
    }
  }
  async uploadChanges(toUpload) {
    const response = await fetch(`${this.settings.serverUrl}/v1/${this.settings.vaultId}/uploadChanges`, {
      method: "POST",
      headers: {
        "Accept-Encoding": "gzip",
        "Content-Type": "application/json",
        "X-API-Key": this.settings.apiKey
      },
      body: JSON.stringify({ "data": toUpload })
    });
    if (!response.ok) {
      throw new Error(`Upload failed: ${response.statusText}`);
    }
  }
  async handleFileDeletion(file) {
    this.settings.deletionQueue.push(file.path);
    this.hashCache.invalidate(file.path);
    await this.saveSettings();
  }
  async handleFileRename(file, oldPath) {
    this.settings.deletionQueue.push(oldPath);
    this.hashCache.invalidate(file.path);
    await this.saveSettings();
  }
  async downloadState() {
    const response = await fetch(
      `${this.settings.serverUrl}/v1/${this.settings.vaultId}/state`,
      {
        headers: {
          "Accept-Encoding": "gzip",
          "X-API-Key": this.settings.apiKey,
          "Content-Encoding": "gzip"
        }
      }
    );
    if (!response.ok) {
      throw new Error(`Download failed: ${response.statusText}`);
    }
    return await response.json().then((data) => {
      console.debug(data);
      return data.state;
    });
  }
  async downloadFiles(files) {
    const response = await fetch(`${this.settings.serverUrl}/v1/${this.settings.vaultId}/downloadFiles`, {
      method: "POST",
      headers: {
        "Accept-Encoding": "gzip",
        "Content-Encoding": "gzip",
        "Content-Type": "application/json",
        "X-API-Key": this.settings.apiKey
      },
      body: JSON.stringify({ files })
    });
    if (!response.ok) {
      throw new Error(`Download failed: ${response.statusText}`);
    }
    return await response.json().then((data) => {
      console.debug(data);
      return data.files;
    });
  }
  async getAllFilesFromServer() {
    const response = await fetch(
      `${this.settings.serverUrl}/v1/${this.settings.vaultId}/allFiles`,
      {
        headers: {
          "Accept-Encoding": "gzip",
          "Content-Encoding": "gzip",
          "X-API-Key": this.settings.apiKey
        }
      }
    );
    if (!response.ok) {
      throw new Error(`Failed to get files: ${response.statusText}`);
    }
    return await response.json();
  }
  async getFileHistory(fileId) {
    const encodedFileId = encodeURIComponent(fileId);
    const response = await fetch(
      `${this.settings.serverUrl}/v1/${this.settings.vaultId}/fileHistory/${encodedFileId}`,
      {
        headers: {
          "Accept-Encoding": "gzip",
          "Content-Encoding": "gzip",
          "X-API-Key": this.settings.apiKey
        }
      }
    );
    if (!response.ok) {
      throw new Error(`Failed to get file history: ${response.statusText}`);
    }
    return await response.json();
  }
};
var SimpleSyncSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Server URL").setDesc("The URL of the sync server").addText((text) => text.setPlaceholder("Enter server URL").setValue(this.plugin.settings.serverUrl).onChange(async (value) => {
      this.plugin.settings.serverUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("API Key").setDesc("The API key for authentication").addText((text) => text.setPlaceholder("Enter API key").setValue(this.plugin.settings.apiKey).onChange(async (value) => {
      this.plugin.settings.apiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Sync Interval").setDesc("The interval (in seconds) at which to sync").addText((text) => text.setPlaceholder("Enter sync interval").setValue(this.plugin.settings.syncInterval.toString()).onChange(async (value) => {
      this.plugin.settings.syncInterval = parseInt(value);
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Pause Sync").setDesc("Pause the sync process").addButton((button) => button.setButtonText("Pause").setCta().onClick(async () => {
      this.plugin.syncPaused = true;
      new import_obsidian.Notice("Sync paused");
    }));
    new import_obsidian.Setting(containerEl).setName("Resume Sync").setDesc("Resume the sync process").addButton((button) => button.setButtonText("Resume").setCta().onClick(async () => {
      this.plugin.syncPaused = false;
      new import_obsidian.Notice("Sync resumed");
    }));
    new import_obsidian.Setting(containerEl).setName("Force Resync").setDesc("Push local state to the remote server").addButton((button) => button.setButtonText("Resync").setCta().onClick(async () => {
      await this.plugin.resync();
      new import_obsidian.Notice("Resync initiated");
    }));
    new import_obsidian.Setting(containerEl).setName("Vault ID").setDesc("The ID of the vault to sync").addText((text) => text.setPlaceholder("Enter vault ID").setValue(this.plugin.settings.vaultId).onChange(async (value) => {
      this.plugin.settings.vaultId = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Full Rehash Interval").setDesc("How often (in minutes) to perform a full rehash of all files").addText((text) => text.setPlaceholder("Enter full rehash interval").setValue(this.plugin.settings.fullRehashInterval.toString()).onChange(async (value) => {
      const interval = parseInt(value);
      if (!isNaN(interval) && interval > 0) {
        this.plugin.settings.fullRehashInterval = interval;
        await this.plugin.saveSettings();
      }
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBCdXR0b25Db21wb25lbnQsIEZ1enp5U3VnZ2VzdE1vZGFsLCBNb2RhbCwgTm90aWNlLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFRGaWxlLCBWYXVsdCB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGludGVyZmFjZSBGaWxlQ29udGVudCB7XG5cdGZpbGVJZDogc3RyaW5nO1xuXHRoYXNoOiBzdHJpbmc7XG5cdG10aW1lOiBudW1iZXI7XG5cdGRlbGV0ZWQ6IGJvb2xlYW47XG5cdGNvbnRlbnQ6IHN0cmluZztcbn1cblxuLy8gaW1wbGVtZW50cyBhbiBpbnRlcmZhY2UgZm9yIHRoZSByZW1vdGUgc3RhdGUgQVBJXG4vLyB0aGUgQVBJIHJldHVybnMgYSBtYXAgb2YgZmlsZUlkIC0+IHtoYXNoLCBtdGltZSwgZGVsZXRlZH1cbmludGVyZmFjZSBGaWxlTWV0YWRhdGEge1xuXHRoYXNoOiBzdHJpbmc7XG5cdG10aW1lOiBudW1iZXI7XG5cdGRlbGV0ZWQ6IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBSZW1vdGVTdGF0ZSB7XG5cdFtmaWxlSWQ6IHN0cmluZ106IEZpbGVNZXRhZGF0YTtcbn1cblxuXG5pbnRlcmZhY2UgSGlzdG9yeUVudHJ5IGV4dGVuZHMgRmlsZUNvbnRlbnQge1xuXHR2ZXJzaW9uX3RpbWU6IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIEZpbGVIaXN0b3J5TW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxzdHJpbmc+IHtcblx0cGx1Z2luOiBTaW1wbGVTeW5jUGx1Z2luO1xuXHRmaWxlczogc3RyaW5nW10gPSBbXTtcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBTaW1wbGVTeW5jUGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLnNldFBsYWNlaG9sZGVyKFwiU2VsZWN0IGEgZmlsZSB0byB2aWV3IGhpc3RvcnlcIik7XG5cdFx0dGhpcy5sb2FkRmlsZXMoKTtcblx0fVxuXG5cdGFzeW5jIGxvYWRGaWxlcygpIHtcblx0XHR0cnkge1xuXHRcdFx0dGhpcy5maWxlcyA9IGF3YWl0IHRoaXMucGx1Z2luLmdldEFsbEZpbGVzRnJvbVNlcnZlcigpO1xuXHRcdFx0dGhpcy5zZXRJbnN0cnVjdGlvbnMoW1xuXHRcdFx0XHR7IGNvbW1hbmQ6IFwiXHUyMTkxXHUyMTkzXCIsIHB1cnBvc2U6IFwidG8gbmF2aWdhdGVcIiB9LFxuXHRcdFx0XHR7IGNvbW1hbmQ6IFwiXHUyMUI1XCIsIHB1cnBvc2U6IFwidG8gc2VsZWN0XCIgfSxcblx0XHRcdFx0eyBjb21tYW5kOiBcImVzY1wiLCBwdXJwb3NlOiBcInRvIGRpc21pc3NcIiB9XG5cdFx0XHRdKTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0bmV3IE5vdGljZShcIkZhaWxlZCB0byBsb2FkIGZpbGVzOiBcIiArIGVycm9yKTtcblx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHR9XG5cdH1cblxuXHRnZXRJdGVtcygpOiBzdHJpbmdbXSB7XG5cdFx0cmV0dXJuIHRoaXMuZmlsZXM7XG5cdH1cblxuXHRnZXRJdGVtVGV4dChpdGVtOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdHJldHVybiBpdGVtO1xuXHR9XG5cblx0b25DaG9vc2VJdGVtKGl0ZW06IHN0cmluZywgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xuXHRcdG5ldyBGaWxlVmVyc2lvbnNNb2RhbCh0aGlzLmFwcCwgdGhpcy5wbHVnaW4sIGl0ZW0pLm9wZW4oKTtcblx0fVxufVxuXG5leHBvcnQgY2xhc3MgRmlsZVZlcnNpb25zTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cdHBsdWdpbjogU2ltcGxlU3luY1BsdWdpbjtcblx0ZmlsZUlkOiBzdHJpbmc7XG5cdHZlcnNpb25zOiBIaXN0b3J5RW50cnlbXSA9IFtdO1xuXHRjb250ZW50RWw6IEhUTUxFbGVtZW50O1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFNpbXBsZVN5bmNQbHVnaW4sIGZpbGVJZDogc3RyaW5nKSB7XG5cdFx0c3VwZXIoYXBwKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLmZpbGVJZCA9IGZpbGVJZDtcblx0fVxuXG5cdGFzeW5jIG9uT3BlbigpIHtcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblx0XHR0aGlzLmNvbnRlbnRFbCA9IGNvbnRlbnRFbDtcblxuXHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJWZXJzaW9uIEhpc3RvcnlcIiB9KTtcblx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogYEZpbGU6ICR7dGhpcy5maWxlSWR9YCB9KTtcblxuXHRcdGNvbnN0IGxvYWRpbmdFbCA9IGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBcIkxvYWRpbmcgdmVyc2lvbnMuLi5cIiB9KTtcblxuXHRcdHRyeSB7XG5cdFx0XHR0aGlzLnZlcnNpb25zID0gYXdhaXQgdGhpcy5wbHVnaW4uZ2V0RmlsZUhpc3RvcnkodGhpcy5maWxlSWQpO1xuXHRcdFx0bG9hZGluZ0VsLnJlbW92ZSgpO1xuXHRcdFx0dGhpcy5kaXNwbGF5VmVyc2lvbnMoKTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0bG9hZGluZ0VsLnNldFRleHQoXCJGYWlsZWQgdG8gbG9hZCB2ZXJzaW9uczogXCIgKyBlcnJvcik7XG5cdFx0fVxuXHR9XG5cblx0ZGlzcGxheVZlcnNpb25zKCkge1xuXHRcdGlmICh0aGlzLnZlcnNpb25zLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhpcy5jb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJObyBoaXN0b3J5IGZvdW5kIGZvciB0aGlzIGZpbGUuXCIgfSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgY29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImhpc3RvcnktY29udGFpbmVyXCIgfSk7XG5cblx0XHRjb250YWluZXIuY3JlYXRlRWwoXCJzdHlsZVwiLCB7XG5cdFx0XHR0ZXh0OiBgXG4gICAgICAgICAgICAgICAgLmhpc3RvcnktY29udGFpbmVyIHtcbiAgICAgICAgICAgICAgICAgICAgbWF4LWhlaWdodDogNDAwcHg7XG4gICAgICAgICAgICAgICAgICAgIG92ZXJmbG93LXk6IGF1dG87XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC52ZXJzaW9uLWl0ZW0ge1xuICAgICAgICAgICAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAxMHB4IDA7XG4gICAgICAgICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC52ZXJzaW9uLWhlYWRlciB7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgICAgICAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogNXB4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAudmVyc2lvbi1jb250ZW50IHtcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAxMHB4O1xuICAgICAgICAgICAgICAgICAgICBtYXJnaW4tdG9wOiAxMHB4O1xuICAgICAgICAgICAgICAgICAgICBtYXgtaGVpZ2h0OiAyMDBweDtcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3cteTogYXV0bztcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogbm9uZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLnZlcnNpb24tY29udGVudC5hY3RpdmUge1xuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBgXG5cdFx0fSk7XG5cblx0XHQvLyBDcmVhdGUgaXRlbXMgZm9yIGVhY2ggdmVyc2lvblxuXHRcdHRoaXMudmVyc2lvbnMuZm9yRWFjaCgodmVyc2lvbiwgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IGl0ZW0gPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZlcnNpb24taXRlbVwiIH0pO1xuXG5cdFx0XHRjb25zdCBoZWFkZXIgPSBpdGVtLmNyZWF0ZURpdih7IGNsczogXCJ2ZXJzaW9uLWhlYWRlclwiIH0pO1xuXHRcdFx0Y29uc3QgZGF0ZSA9IG5ldyBEYXRlKHZlcnNpb24udmVyc2lvbl90aW1lKTtcblxuXHRcdFx0aGVhZGVyLmNyZWF0ZUVsKFwiZGl2XCIsIHtcblx0XHRcdFx0dGV4dDogYFZlcnNpb24gJHtpbmRleCArIDF9IC0gJHtkYXRlLnRvTG9jYWxlU3RyaW5nKCl9YFxuXHRcdFx0fSk7XG5cblx0XHRcdGNvbnN0IGJ1dHRvblJvdyA9IGhlYWRlci5jcmVhdGVEaXYoKTtcblxuXHRcdFx0Ly8gVG9nZ2xlIGNvbnRlbnQgYnV0dG9uXG5cdFx0XHRjb25zdCB0b2dnbGVCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvblJvdylcblx0XHRcdFx0LnNldEJ1dHRvblRleHQoXCJWaWV3XCIpXG5cdFx0XHRcdC5vbkNsaWNrKCgpID0+IHtcblx0XHRcdFx0XHRjb25zdCBjb250ZW50ID0gaXRlbS5xdWVyeVNlbGVjdG9yKFwiLnZlcnNpb24tY29udGVudFwiKTtcblx0XHRcdFx0XHRpZiAoY29udGVudCkge1xuXHRcdFx0XHRcdFx0Y29udGVudC5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlXCIpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR0b2dnbGVCdG4uc2V0QnV0dG9uVGV4dChcblx0XHRcdFx0XHRcdGNvbnRlbnQ/LmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2ZVwiKSA/IFwiSGlkZVwiIDogXCJWaWV3XCJcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0Ly8gUmVzdG9yZSBidXR0b25cblx0XHRcdGlmIChpbmRleCA+IDApIHsgLy8gRG9uJ3QgYWxsb3cgcmVzdG9yaW5nIHRoZSBtb3N0IHJlY2VudCB2ZXJzaW9uXG5cdFx0XHRcdG5ldyBCdXR0b25Db21wb25lbnQoYnV0dG9uUm93KVxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KFwiUmVzdG9yZVwiKVxuXHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucmVzdG9yZVZlcnNpb24odmVyc2lvbik7XG5cdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJWZXJzaW9uIHJlc3RvcmVkIHN1Y2Nlc3NmdWxseVwiKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5jbG9zZSgpO1xuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZShcIkZhaWxlZCB0byByZXN0b3JlIHZlcnNpb246IFwiICsgZXJyb3IpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBWZXJzaW9uIGNvbnRlbnQgKGluaXRpYWxseSBoaWRkZW4pXG5cdFx0XHRjb25zdCBjb250ZW50ID0gaXRlbS5jcmVhdGVEaXYoeyBjbHM6IFwidmVyc2lvbi1jb250ZW50XCIgfSk7XG5cdFx0XHRjb250ZW50LmNyZWF0ZUVsKFwicHJlXCIsIHsgdGV4dDogdmVyc2lvbi5jb250ZW50IH0pO1xuXHRcdH0pO1xuXHR9XG5cblx0YXN5bmMgcmVzdG9yZVZlcnNpb24odmVyc2lvbjogSGlzdG9yeUVudHJ5KSB7XG5cdFx0Ly8gRmlyc3QgY2hlY2sgaWYgdGhlIGZpbGUgZXhpc3RzIGxvY2FsbHlcblx0XHRjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0RmlsZUJ5UGF0aCh0aGlzLmZpbGVJZCk7XG5cblx0XHRpZiAoZmlsZSkge1xuXHRcdFx0Ly8gRmlsZSBleGlzdHMsIG1vZGlmeSBpdFxuXHRcdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIHZlcnNpb24uY29udGVudCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIEZpbGUgZG9lc24ndCBleGlzdCwgY3JlYXRlIGl0XG5cdFx0XHQvLyBGaXJzdCBlbnN1cmUgYWxsIHBhcmVudCBmb2xkZXJzIGV4aXN0XG5cdFx0XHRjb25zdCBwYXRoID0gdGhpcy5maWxlSWQuc3BsaXQoJy8nKTtcblx0XHRcdGNvbnN0IGZpbGVOYW1lID0gcGF0aC5wb3AoKTtcblx0XHRcdGxldCBmb2xkZXJQYXRoID0gJyc7XG5cblx0XHRcdGZvciAoY29uc3QgZm9sZGVyIG9mIHBhdGgpIHtcblx0XHRcdFx0Zm9sZGVyUGF0aCArPSBmb2xkZXI7XG5cdFx0XHRcdGNvbnN0IGV4aXN0cyA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJQYXRoKTtcblx0XHRcdFx0aWYgKCFleGlzdHMpIHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGVGb2xkZXIoZm9sZGVyUGF0aCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Zm9sZGVyUGF0aCArPSAnLyc7XG5cdFx0XHR9XG5cblx0XHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZSh0aGlzLmZpbGVJZCwgdmVyc2lvbi5jb250ZW50KTtcblx0XHR9XG5cblx0XHQvLyBGb3JjZSBhIHN5bmNcblx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zeW5jKCk7XG5cdH1cblxuXHRvbkNsb3NlKCkge1xuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xuXHR9XG59XG5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhc2hGaWxlKGZpbGU6IFRGaWxlKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0Y29uc3QgY29udGVudCA9IGF3YWl0IGZpbGUudmF1bHQucmVhZChmaWxlKTtcblx0Y29uc3QgbXNnQnVmZmVyID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGNvbnRlbnQpO1xuXHRjb25zdCBoYXNoQnVmZmVyID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5kaWdlc3QoJ1NIQS0yNTYnLCBtc2dCdWZmZXIpO1xuXHRjb25zdCBoYXNoQXJyYXkgPSBBcnJheS5mcm9tKG5ldyBVaW50OEFycmF5KGhhc2hCdWZmZXIpKTtcblx0cmV0dXJuIGhhc2hBcnJheS5tYXAoYiA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKS5qb2luKCcnKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbEZpbGVzKHZhdWx0OiBWYXVsdCk6IFByb21pc2U8VEZpbGVbXT4ge1xuXHRyZXR1cm4gdmF1bHQuZ2V0QWxsTG9hZGVkRmlsZXMoKVxuXHRcdC5maWx0ZXIoZmlsZSA9PiBmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiZcblx0XHRcdChmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJyB8fCBpc0ltYWdlRmlsZShmaWxlLmV4dGVuc2lvbikpKSBhcyBURmlsZVtdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNJbWFnZUZpbGUoZXh0ZW5zaW9uOiBzdHJpbmcpOiBib29sZWFuIHtcblx0cmV0dXJuIFsncG5nJywgJ2pwZycsICdqcGVnJywgJ2dpZicsICdzdmcnXS5pbmNsdWRlcyhleHRlbnNpb24udG9Mb3dlckNhc2UoKSk7XG59XG5cblxuaW50ZXJmYWNlIFNpbXBsZVN5bmNQbHVnaW5TZXR0aW5ncyB7XG5cdHNlcnZlclVybDogc3RyaW5nO1xuXHRhcGlLZXk6IHN0cmluZztcblx0c3luY0ludGVydmFsOiBudW1iZXI7IC8vIGluIHNlY29uZHNcblx0bGFzdFN5bmM6IG51bWJlcjtcblx0ZGVsZXRpb25RdWV1ZTogc3RyaW5nW107XG5cdHZhdWx0SWQ6IHN0cmluZztcblx0ZnVsbFJlaGFzaEludGVydmFsOiBudW1iZXI7IC8vIGluIG1pbnV0ZXNcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogU2ltcGxlU3luY1BsdWdpblNldHRpbmdzID0ge1xuXHRzZXJ2ZXJVcmw6ICcnLFxuXHRhcGlLZXk6ICcnLFxuXHRzeW5jSW50ZXJ2YWw6IDYwLCAvLyBpbiBzZWNvbmRzXG5cdGxhc3RTeW5jOiAwLFxuXHRkZWxldGlvblF1ZXVlOiBbXSxcblx0dmF1bHRJZDogJycsXG5cdGZ1bGxSZWhhc2hJbnRlcnZhbDogMTUgLy8gMTUgbWludXRlcyBkZWZhdWx0XG59XG5cbmludGVyZmFjZSBIYXNoQ2FjaGVFbnRyeSB7XG5cdGhhc2g6IHN0cmluZztcblx0dGltZXN0YW1wOiBudW1iZXI7XG59XG5cbmNsYXNzIEhhc2hDYWNoZSB7XG5cdHByaXZhdGUgY2FjaGU6IE1hcDxzdHJpbmcsIEhhc2hDYWNoZUVudHJ5PiA9IG5ldyBNYXAoKTtcblx0cHJpdmF0ZSByZWFkb25seSBDQUNIRV9MSUZFVElNRSA9IDM2MDAwMDA7IC8vIDEgaG91ciBpbiBtaWxsaXNlY29uZHNcblxuXHRzZXQocGF0aDogc3RyaW5nLCBoYXNoOiBzdHJpbmcpIHtcblx0XHR0aGlzLmNhY2hlLnNldChwYXRoLCB7XG5cdFx0XHRoYXNoOiBoYXNoLFxuXHRcdFx0dGltZXN0YW1wOiBEYXRlLm5vdygpXG5cdFx0fSk7XG5cdH1cblxuXHRnZXQocGF0aDogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG5cdFx0Y29uc3QgZW50cnkgPSB0aGlzLmNhY2hlLmdldChwYXRoKTtcblx0XHRpZiAoIWVudHJ5KSByZXR1cm4gbnVsbDtcblxuXHRcdC8vIFJldHVybiBudWxsIGlmIGNhY2hlIGVudHJ5IGlzIHRvbyBvbGRcblx0XHRpZiAoRGF0ZS5ub3coKSAtIGVudHJ5LnRpbWVzdGFtcCA+IHRoaXMuQ0FDSEVfTElGRVRJTUUpIHtcblx0XHRcdHRoaXMuY2FjaGUuZGVsZXRlKHBhdGgpO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGVudHJ5Lmhhc2g7XG5cdH1cblxuXHRpbnZhbGlkYXRlKHBhdGg6IHN0cmluZykge1xuXHRcdHRoaXMuY2FjaGUuZGVsZXRlKHBhdGgpO1xuXHR9XG5cblx0Y2xlYXIoKSB7XG5cdFx0dGhpcy5jYWNoZS5jbGVhcigpO1xuXHR9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNpbXBsZVN5bmNQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuXHRzZXR0aW5nczogU2ltcGxlU3luY1BsdWdpblNldHRpbmdzO1xuXHRzdGF0dXNCYXJJdGVtRWw6IEhUTUxFbGVtZW50O1xuXHRzeW5jUGF1c2VkOiBib29sZWFuID0gZmFsc2U7XG5cdHByaXZhdGUgaGFzaENhY2hlOiBIYXNoQ2FjaGU7XG5cdHByaXZhdGUgbGFzdEZ1bGxSZWhhc2g6IG51bWJlciA9IDA7XG5cdHByaXZhdGUgc3luY2luZzogYm9vbGVhbiA9IGZhbHNlO1xuXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHR0aGlzLmhhc2hDYWNoZSA9IG5ldyBIYXNoQ2FjaGUoKTtcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXHRcdGlmICghdGhpcy5zZXR0aW5ncy52YXVsdElkKSB7XG5cdFx0XHR0aGlzLnNldHRpbmdzLnZhdWx0SWQgPSB0aGlzLmFwcC52YXVsdC5nZXROYW1lKCk7XG5cdFx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuXHRcdH1cblxuXHRcdC8vIFRoaXMgYWRkcyBhIHN0YXR1cyBiYXIgaXRlbSB0byB0aGUgYm90dG9tIG9mIHRoZSBhcHAuIERvZXMgbm90IHdvcmsgb24gbW9iaWxlIGFwcHMuXG5cdFx0dGhpcy5zdGF0dXNCYXJJdGVtRWwgPSB0aGlzLmFkZFN0YXR1c0Jhckl0ZW0oKTtcblx0XHR0aGlzLnN0YXR1c0Jhckl0ZW1FbC5zZXRUZXh0KCdMYXN0IHN5bmM6IE5ldmVyJyk7XG5cblx0XHQvLyBUaGlzIGFkZHMgYSBzZXR0aW5ncyB0YWIgc28gdGhlIHVzZXIgY2FuIGNvbmZpZ3VyZSB2YXJpb3VzIGFzcGVjdHMgb2YgdGhlIHBsdWdpblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgU2ltcGxlU3luY1NldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcblxuXHRcdC8vIFJlZ2lzdGVyIGV2ZW50IHRvIGhhbmRsZSBmaWxlIGRlbGV0aW9uc1xuXHRcdHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC52YXVsdC5vbignZGVsZXRlJywgdGhpcy5oYW5kbGVGaWxlRGVsZXRpb24uYmluZCh0aGlzKSkpO1xuXHRcdHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC52YXVsdC5vbigncmVuYW1lJywgdGhpcy5oYW5kbGVGaWxlUmVuYW1lLmJpbmQodGhpcykpKTtcblxuXHRcdC8vIFJlZ2lzdGVyIGV2ZW50IHRvIGludmFsaWRhdGUgaGFzaCBjYWNoZSBvbiBmaWxlIG1vZGlmaWNhdGlvblxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMuYXBwLnZhdWx0Lm9uKCdtb2RpZnknLCBmaWxlID0+IHtcblx0XHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuXHRcdFx0XHRcdHRoaXMuaGFzaENhY2hlLmludmFsaWRhdGUoZmlsZS5wYXRoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHQpO1xuXG5cdFx0Ly8gU3RhcnQgdGhlIHN5bmMgbG9vcFxuXHRcdHRoaXMucmVnaXN0ZXJJbnRlcnZhbCh3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4gdGhpcy5zeW5jKCksIHRoaXMuc2V0dGluZ3Muc3luY0ludGVydmFsICogMTAwMCkpO1xuXG5cdFx0dGhpcy5hZGRSaWJib25JY29uKCdjbG9jaycsICdWaWV3IEZpbGUgSGlzdG9yeScsICgpID0+IHtcblx0XHRcdG5ldyBGaWxlSGlzdG9yeU1vZGFsKHRoaXMuYXBwLCB0aGlzKS5vcGVuKCk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6ICdvcGVuLWZpbGUtaGlzdG9yeS1tb2RhbCcsXG5cdFx0XHRuYW1lOiAnT3BlbiBGaWxlIEhpc3RvcnkgQnJvd3NlcicsXG5cdFx0XHRjYWxsYmFjazogKCkgPT4ge1xuXHRcdFx0XHRuZXcgRmlsZUhpc3RvcnlNb2RhbCh0aGlzLmFwcCwgdGhpcykub3BlbigpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogJ3ZpZXctY3VycmVudC1maWxlLWhpc3RvcnknLFxuXHRcdFx0bmFtZTogJ1ZpZXcgSGlzdG9yeSBmb3IgQ3VycmVudCBGaWxlJyxcblx0XHRcdGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZykgPT4ge1xuXHRcdFx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdFx0aWYgKGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0XHRpZiAoIWNoZWNraW5nKSB7XG5cdFx0XHRcdFx0XHRuZXcgRmlsZVZlcnNpb25zTW9kYWwodGhpcy5hcHAsIHRoaXMsIGFjdGl2ZUZpbGUucGF0aCkub3BlbigpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRvbnVubG9hZCgpIHtcblx0XHQvLyBDbGVhciBhbnkgaW50ZXJ2YWxzIG9yIGxpc3RlbmVyc1xuXHR9XG5cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuXHR9XG5cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdH1cblxuXHRhc3luYyByZXN5bmMoKSB7XG5cdFx0Y29uc29sZS5pbmZvKCdTdGFydGluZyByZXN5bmMuLi4nKTtcblxuXHRcdC8vIEdldCBsb2NhbCBhbmQgcmVtb3RlIHN0YXRlXG5cdFx0Y29uc29sZS5pbmZvKCdGZXRjaGluZyByZW1vdGUgc3RhdGUuLi4nKTtcblx0XHRjb25zdCByZW1vdGVTdGF0ZSA9IGF3YWl0IHRoaXMuZG93bmxvYWRTdGF0ZSgpO1xuXHRcdGNvbnN0IHJlbW90ZUZpbGVzID0gT2JqZWN0LmtleXMocmVtb3RlU3RhdGUpO1xuXHRcdGNvbnNvbGUuaW5mbyhgRm91bmQgJHtyZW1vdGVGaWxlcy5sZW5ndGh9IGZpbGVzIG9uIHJlbW90ZWApO1xuXG5cdFx0Y29uc29sZS5pbmZvKCdHZXR0aW5nIGxvY2FsIGZpbGVzLi4uJyk7XG5cdFx0Y29uc3QgbG9jYWxGaWxlcyA9IGF3YWl0IGdldEFsbEZpbGVzKHRoaXMuYXBwLnZhdWx0KTtcblx0XHRjb25zb2xlLmluZm8oYEZvdW5kICR7bG9jYWxGaWxlcy5sZW5ndGh9IGZpbGVzIGxvY2FsbHlgKTtcblxuXHRcdC8vIE1hcmsgYWxsIHJlbW90ZS1vbmx5IGZpbGVzIGZvciBkZWxldGlvblxuXHRcdGNvbnN0IHJlbW90ZU9ubHkgPSByZW1vdGVGaWxlcy5maWx0ZXIoZmlsZSA9PiAhbG9jYWxGaWxlcy5tYXAoZmlsZSA9PiBmaWxlLnBhdGgpLmluY2x1ZGVzKGZpbGUpKTtcblx0XHRjb25zb2xlLmluZm8oYEZvdW5kICR7cmVtb3RlT25seS5sZW5ndGh9IGZpbGVzIHRvIGRlbGV0ZSBmcm9tIHJlbW90ZWApO1xuXG5cdFx0Zm9yIChjb25zdCBmaWxlSWQgb2YgcmVtb3RlT25seSkge1xuXHRcdFx0Y29uc29sZS5kZWJ1ZyhgTWFya2luZyAke2ZpbGVJZH0gZm9yIGRlbGV0aW9uYCk7XG5cdFx0XHR0aGlzLnNldHRpbmdzLmRlbGV0aW9uUXVldWUucHVzaChmaWxlSWQpO1xuXHRcdH1cblx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuXG5cdFx0Ly8gVXBsb2FkIGFsbCBsb2NhbCBmaWxlc1xuXHRcdGNvbnNvbGUuaW5mbygnUHJlcGFyaW5nIHRvIHVwbG9hZCBhbGwgbG9jYWwgZmlsZXMuLi4nKTtcblx0XHRjb25zdCB1cGxvYWRzOiBGaWxlQ29udGVudFtdID0gW107XG5cdFx0Zm9yIChjb25zdCBmaWxlIG9mIGxvY2FsRmlsZXMpIHtcblx0XHRcdGNvbnNvbGUuZGVidWcoYFByb2Nlc3NpbmcgJHtmaWxlLnBhdGh9YCk7XG5cdFx0XHRjb25zdCBoYXNoID0gYXdhaXQgaGFzaEZpbGUoZmlsZSk7XG5cdFx0XHR1cGxvYWRzLnB1c2goe1xuXHRcdFx0XHRmaWxlSWQ6IGZpbGUucGF0aCxcblx0XHRcdFx0aGFzaDogaGFzaCxcblx0XHRcdFx0bXRpbWU6IGZpbGUuc3RhdC5tdGltZSxcblx0XHRcdFx0Y29udGVudDogYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKSxcblx0XHRcdFx0ZGVsZXRlZDogZmFsc2Vcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8vIFVwbG9hZCBjaGFuZ2VzXG5cdFx0Y29uc29sZS5pbmZvKGBVcGxvYWRpbmcgJHt1cGxvYWRzLmxlbmd0aH0gZmlsZXMuLi5gKTtcblx0XHRhd2FpdCB0aGlzLnVwbG9hZENoYW5nZXModXBsb2Fkcyk7XG5cdFx0Y29uc29sZS5pbmZvKCdGaWxlIHVwbG9hZCBjb21wbGV0ZScpO1xuXG5cdFx0Ly8gUHJvY2VzcyBkZWxldGlvbnNcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5kZWxldGlvblF1ZXVlLmxlbmd0aCA+IDApIHtcblx0XHRcdGNvbnNvbGUuaW5mbyhgUHJvY2Vzc2luZyAke3RoaXMuc2V0dGluZ3MuZGVsZXRpb25RdWV1ZS5sZW5ndGh9IGRlbGV0aW9ucy4uLmApO1xuXHRcdFx0YXdhaXQgdGhpcy51cGxvYWRDaGFuZ2VzKHRoaXMuc2V0dGluZ3MuZGVsZXRpb25RdWV1ZS5tYXAoZmlsZUlkID0+ICh7XG5cdFx0XHRcdGZpbGVJZDogZmlsZUlkLFxuXHRcdFx0XHRoYXNoOiAnJyxcblx0XHRcdFx0bXRpbWU6IERhdGUubm93KCksXG5cdFx0XHRcdGNvbnRlbnQ6ICcnLFxuXHRcdFx0XHRkZWxldGVkOiB0cnVlXG5cdFx0XHR9KSkpO1xuXHRcdFx0dGhpcy5zZXR0aW5ncy5kZWxldGlvblF1ZXVlID0gW107XG5cdFx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0Y29uc29sZS5pbmZvKCdEZWxldGlvbnMgY29tcGxldGUnKTtcblx0XHR9XG5cblx0XHRjb25zb2xlLmluZm8oJ1Jlc3luYyBjb21wbGV0ZScpO1xuXHRcdG5ldyBOb3RpY2UoJ1Jlc3luYyBjb21wbGV0ZScpO1xuXHRcdHRoaXMuc3RhdHVzQmFySXRlbUVsLnNldFRleHQoJ0xhc3Qgc3luYzogJyArIG5ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCkpO1xuXHR9XG5cblx0YXN5bmMgc3luYygpIHtcblx0XHRpZiAodGhpcy5zeW5jUGF1c2VkKSB7XG5cdFx0XHR0aGlzLnN0YXR1c0Jhckl0ZW1FbC5zZXRUZXh0KCdTeW5jIHBhdXNlZCcpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLnN5bmNpbmcpIHtcblx0XHRcdGNvbnNvbGUuaW5mbygnU3luYyBhbHJlYWR5IGluIHByb2dyZXNzLCBza2lwcGluZy4uLicpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuc3luY2luZyA9IHRydWU7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIENoZWNrIGlmIHdlIG5lZWQgdG8gZG8gYSBmdWxsIHJlaGFzaFxuXHRcdFx0aWYgKERhdGUubm93KCkgLSB0aGlzLmxhc3RGdWxsUmVoYXNoID4gdGhpcy5zZXR0aW5ncy5mdWxsUmVoYXNoSW50ZXJ2YWwgKiA2MDAwMCkge1xuXHRcdFx0XHRjb25zb2xlLmluZm8oJ1BlcmZvcm1pbmcgcGVyaW9kaWMgZnVsbCByZWhhc2guLi4nKTtcblx0XHRcdFx0dGhpcy5oYXNoQ2FjaGUuY2xlYXIoKTtcblx0XHRcdFx0dGhpcy5sYXN0RnVsbFJlaGFzaCA9IERhdGUubm93KCk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuc3RhdHVzQmFySXRlbUVsLnNldFRleHQoJ1N5bmNpbmcuLi4nKTtcblx0XHRcdGNvbnNvbGUuaW5mbygnU3luY2luZy4uLicpO1xuXHRcdFx0Y29uc3QgZmlsZXMgPSBhd2FpdCBnZXRBbGxGaWxlcyh0aGlzLmFwcC52YXVsdCk7XG5cblx0XHRcdGNvbnNvbGUuaW5mbygnTnVtYmVyIG9mIGZpbGVzOicsIGZpbGVzLmxlbmd0aCk7XG5cdFx0XHRjb25zb2xlLmRlYnVnKCdGaWxlczonLCBmaWxlcy5tYXAoZmlsZSA9PiBmaWxlLnBhdGgpKTtcblx0XHRcdGNvbnNvbGUuZGVidWcoJ0RlbGV0aW9uIHF1ZXVlOicsIHRoaXMuc2V0dGluZ3MuZGVsZXRpb25RdWV1ZSk7XG5cblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmRlbGV0aW9uUXVldWUubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnVwbG9hZENoYW5nZXModGhpcy5zZXR0aW5ncy5kZWxldGlvblF1ZXVlLm1hcChmaWxlSWQgPT4gKHtcblx0XHRcdFx0XHRmaWxlSWQ6IGZpbGVJZCxcblx0XHRcdFx0XHRoYXNoOiAnJyxcblx0XHRcdFx0XHRtdGltZTogRGF0ZS5ub3coKSxcblx0XHRcdFx0XHRjb250ZW50OiAnJyxcblx0XHRcdFx0XHRkZWxldGVkOiB0cnVlXG5cdFx0XHRcdH0pKSk7XG5cdFx0XHRcdHRoaXMuc2V0dGluZ3MuZGVsZXRpb25RdWV1ZSA9IFtdO1xuXHRcdFx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zb2xlLmluZm8oJ0Rvd25sb2FkaW5nIHJlbW90ZSBjaGFuZ2VzLi4uJyk7XG5cdFx0XHRjb25zdCByZW1vdGVDaGFuZ2VzID0gYXdhaXQgdGhpcy5kb3dubG9hZFN0YXRlKCk7XG5cblx0XHRcdGNvbnN0IHRvVXBsb2FkOiBGaWxlQ29udGVudFtdID0gW107XG5cdFx0XHRjb25zdCB0b0Rvd25sb2FkOiBzdHJpbmdbXSA9IFtdO1xuXG5cdFx0XHRjb25zb2xlLmluZm8oJ0NoZWNraW5nIGZvciBjaGFuZ2VzLi4uJyk7XG5cdFx0XHRjb25zdCBjaGVja1N0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7XG5cdFx0XHRmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcblx0XHRcdFx0bGV0IGhhc2ggPSB0aGlzLmhhc2hDYWNoZS5nZXQoZmlsZS5wYXRoKTtcblx0XHRcdFx0aWYgKCFoYXNoKSB7XG5cdFx0XHRcdFx0aGFzaCA9IGF3YWl0IGhhc2hGaWxlKGZpbGUpO1xuXHRcdFx0XHRcdHRoaXMuaGFzaENhY2hlLnNldChmaWxlLnBhdGgsIGhhc2gpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgcmVtb3RlRmlsZSA9IHJlbW90ZUNoYW5nZXNbZmlsZS5wYXRoXTtcblx0XHRcdFx0aWYgKCFyZW1vdGVGaWxlKSB7XG5cdFx0XHRcdFx0Ly8gRmlsZSBkb2VzIG5vdCBleGlzdCBvbiBzZXJ2ZXJcblx0XHRcdFx0XHR0b1VwbG9hZC5wdXNoKHtcblx0XHRcdFx0XHRcdGZpbGVJZDogZmlsZS5wYXRoLFxuXHRcdFx0XHRcdFx0aGFzaDogaGFzaCxcblx0XHRcdFx0XHRcdG10aW1lOiBmaWxlLnN0YXQubXRpbWUsXG5cdFx0XHRcdFx0XHRjb250ZW50OiBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpLFxuXHRcdFx0XHRcdFx0ZGVsZXRlZDogZmFsc2Vcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2UgaWYgKHJlbW90ZUZpbGUuaGFzaCAhPT0gaGFzaCkge1xuXHRcdFx0XHRcdC8vIEZpbGUgaGFzIGNoYW5nZWRcblx0XHRcdFx0XHQvLyBSZWhhc2ggdGhlIGZpbGVcblx0XHRcdFx0XHRoYXNoID0gYXdhaXQgaGFzaEZpbGUoZmlsZSk7XG5cdFx0XHRcdFx0dGhpcy5oYXNoQ2FjaGUuc2V0KGZpbGUucGF0aCwgaGFzaCk7XG5cblx0XHRcdFx0XHRpZiAocmVtb3RlRmlsZS5oYXNoICE9PSBoYXNoKSB7XG5cdFx0XHRcdFx0XHQvLyBDaGVjayBpZiB0aGUgcmVtb3RlIG9yIGxvY2FsIGZpbGUgaXMgbmV3ZXJcblx0XHRcdFx0XHRcdGlmIChyZW1vdGVGaWxlLm10aW1lID4gZmlsZS5zdGF0Lm10aW1lKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFJlbW90ZSBmaWxlIGlzIG5ld2VyXG5cdFx0XHRcdFx0XHRcdHRvRG93bmxvYWQucHVzaChmaWxlLnBhdGgpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0Ly8gTG9jYWwgZmlsZSBpcyBuZXdlclx0XHRcblx0XHRcdFx0XHRcdFx0dG9VcGxvYWQucHVzaCh7XG5cdFx0XHRcdFx0XHRcdFx0ZmlsZUlkOiBmaWxlLnBhdGgsXG5cdFx0XHRcdFx0XHRcdFx0aGFzaDogaGFzaCxcblx0XHRcdFx0XHRcdFx0XHRtdGltZTogZmlsZS5zdGF0Lm10aW1lLFxuXHRcdFx0XHRcdFx0XHRcdGNvbnRlbnQ6IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSksXG5cdFx0XHRcdFx0XHRcdFx0ZGVsZXRlZDogZmFsc2Vcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRjb25zdCB0b3RhbENoZWNrVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gY2hlY2tTdGFydDtcblx0XHRcdGNvbnNvbGUuaW5mbyhgQ2hhbmdlIGRldGVjdGlvbiBjb21wbGV0ZWQgaW4gJHt0b3RhbENoZWNrVGltZS50b0ZpeGVkKDIpfW1zYCk7XG5cdFx0XHRjb25zb2xlLmluZm8oJ0ZvdW5kIGxvY2FsIGNoYW5nZXM6JywgdG9VcGxvYWQubGVuZ3RoLCAncmVtb3RlIGNoYW5nZXM6JywgdG9Eb3dubG9hZC5sZW5ndGgpO1xuXHRcdFx0Y29uc29sZS5pbmZvKCdDaGVja2luZyBmb3IgcmVtb3RlLW9ubHkgZmlsZXMuLi4nKTtcblx0XHRcdGNvbnN0IHJlbW90ZUZpbGVzID0gT2JqZWN0LmtleXMocmVtb3RlQ2hhbmdlcyk7XG5cdFx0XHRjb25zdCBsb2NhbEZpbGVzID0gZmlsZXMubWFwKGZpbGUgPT4gZmlsZS5wYXRoKTtcblx0XHRcdGNvbnN0IHJlbW90ZU9ubHkgPSByZW1vdGVGaWxlcy5maWx0ZXIoZmlsZSA9PiAhbG9jYWxGaWxlcy5pbmNsdWRlcyhmaWxlKSk7XG5cdFx0XHRmb3IgKGNvbnN0IGZpbGVJZCBvZiByZW1vdGVPbmx5KSB7XG5cdFx0XHRcdGNvbnN0IHJlbW90ZUZpbGUgPSByZW1vdGVDaGFuZ2VzW2ZpbGVJZF07XG5cdFx0XHRcdGlmICghcmVtb3RlRmlsZS5kZWxldGVkKSB7XG5cdFx0XHRcdFx0dG9Eb3dubG9hZC5wdXNoKGZpbGVJZCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Y29uc29sZS5pbmZvKCdVcGxvYWRpbmcgY2hhbmdlczonLCB0b1VwbG9hZC5sZW5ndGgpO1xuXHRcdFx0aWYgKHRvVXBsb2FkLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0YXdhaXQgdGhpcy51cGxvYWRDaGFuZ2VzKHRvVXBsb2FkKTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc29sZS5pbmZvKCdEb3dubG9hZGluZyByZW1vdGUgZmlsZXM6JywgdG9Eb3dubG9hZC5sZW5ndGgpO1xuXHRcdFx0aWYgKHRvRG93bmxvYWQubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjb25zdCByZW1vdGVGaWxlcyA9IGF3YWl0IHRoaXMuZG93bmxvYWRGaWxlcyh0b0Rvd25sb2FkKTtcblx0XHRcdFx0Y29uc29sZS5kZWJ1ZyhyZW1vdGVGaWxlcyk7XG5cdFx0XHRcdGNvbnNvbGUuaW5mbygnUHJvY2Vzc2luZyByZW1vdGUgZmlsZXMuLi4nKTtcblx0XHRcdFx0Zm9yIChjb25zdCBmaWxlIG9mIHJlbW90ZUZpbGVzKSB7XG5cdFx0XHRcdFx0Ly8gY2hlY2sgaWYgdGhlIGZpbGUgd2FzIG1hcmtlZCBhcyBkZWxldGVkXG5cdFx0XHRcdFx0aWYgKGZpbGUuZGVsZXRlZCkge1xuXHRcdFx0XHRcdFx0Ly8gZGVsZXRlIHRoZSBmaWxlIGxvY2FsbHlcblx0XHRcdFx0XHRcdGNvbnNvbGUuaW5mbygnRGVsZXRpbmcgZmlsZTonLCBmaWxlLmZpbGVJZCk7XG5cdFx0XHRcdFx0XHRjb25zdCBsb2NhbEZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRGaWxlQnlQYXRoKGZpbGUuZmlsZUlkKTtcblx0XHRcdFx0XHRcdGlmIChsb2NhbEZpbGUpIHtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQuZGVsZXRlKGxvY2FsRmlsZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIHVwZGF0ZSB0aGUgZmlsZSBsb2NhbGx5XG5cdFx0XHRcdFx0XHRjb25zdCBsb2NhbEZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRGaWxlQnlQYXRoKGZpbGUuZmlsZUlkKTtcblx0XHRcdFx0XHRcdC8vIGlmIHRoZSBmaWxlIGRvZXMgbm90IGV4aXN0IGxvY2FsbHksIGNyZWF0ZSBpdCByZWN1cnNpdmVseVxuXHRcdFx0XHRcdFx0aWYgKCFsb2NhbEZpbGUpIHtcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5pbmZvKCdDcmVhdGluZyBmaWxlOicsIGZpbGUuZmlsZUlkKTtcblx0XHRcdFx0XHRcdFx0Ly8gY2hlY2sgaWYgZm9sZGVycyBleGlzdCwgaWYgbm90IGNyZWF0ZSB0aGVtXG5cdFx0XHRcdFx0XHRcdGNvbnN0IHBhdGggPSBmaWxlLmZpbGVJZC5zcGxpdCgnLycpO1xuXHRcdFx0XHRcdFx0XHRsZXQgZm9sZGVyUGF0aCA9ICcnO1xuXHRcdFx0XHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHBhdGgubGVuZ3RoIC0gMTsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0Zm9sZGVyUGF0aCArPSBwYXRoW2ldO1xuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGZvbGRlciA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVCeVBhdGgoZm9sZGVyUGF0aCk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKCFmb2xkZXIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnNvbGUuaW5mbygnQ3JlYXRpbmcgZm9sZGVyOicsIGZvbGRlclBhdGgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlRm9sZGVyKGZvbGRlclBhdGgpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRmb2xkZXJQYXRoICs9ICcvJztcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHQvLyBjcmVhdGUgdGhlIGZpbGVcdFxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoZmlsZS5maWxlSWQsIGZpbGUuY29udGVudCk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRjb25zb2xlLmluZm8oJ1VwZGF0aW5nIGZpbGU6JywgZmlsZS5maWxlSWQpO1xuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkobG9jYWxGaWxlLCBmaWxlLmNvbnRlbnQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLnNldHRpbmdzLmxhc3RTeW5jID0gRGF0ZS5ub3coKTtcblx0XHRcdGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRjb25zb2xlLmluZm8oJ1N5bmMgY29tcGxldGUnKTtcblx0XHRcdHRoaXMuc3RhdHVzQmFySXRlbUVsLnNldFRleHQoJ0xhc3Qgc3luYzogJyArIG5ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCkpO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHR0aGlzLnN0YXR1c0Jhckl0ZW1FbC5zZXRUZXh0KCdTeW5jIGZhaWxlZCcpO1xuXHRcdFx0Y29uc29sZS5lcnJvcignU3luYyBlcnJvcjonLCBlcnJvcik7XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHRoaXMuc3luY2luZyA9IGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgdXBsb2FkQ2hhbmdlcyh0b1VwbG9hZDogRmlsZUNvbnRlbnRbXSkge1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5zZXR0aW5ncy5zZXJ2ZXJVcmx9L3YxLyR7dGhpcy5zZXR0aW5ncy52YXVsdElkfS91cGxvYWRDaGFuZ2VzYCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdBY2NlcHQtRW5jb2RpbmcnOiAnZ3ppcCcsXG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdCdYLUFQSS1LZXknOiB0aGlzLnNldHRpbmdzLmFwaUtleVxuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgXCJkYXRhXCI6IHRvVXBsb2FkIH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYFVwbG9hZCBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGhhbmRsZUZpbGVEZWxldGlvbihmaWxlOiBURmlsZSkge1xuXHRcdHRoaXMuc2V0dGluZ3MuZGVsZXRpb25RdWV1ZS5wdXNoKGZpbGUucGF0aCk7XG5cdFx0dGhpcy5oYXNoQ2FjaGUuaW52YWxpZGF0ZShmaWxlLnBhdGgpO1xuXHRcdGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGhhbmRsZUZpbGVSZW5hbWUoZmlsZTogVEZpbGUsIG9sZFBhdGg6IHN0cmluZykge1xuXHRcdHRoaXMuc2V0dGluZ3MuZGVsZXRpb25RdWV1ZS5wdXNoKG9sZFBhdGgpO1xuXHRcdHRoaXMuaGFzaENhY2hlLmludmFsaWRhdGUoZmlsZS5wYXRoKTtcblx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBkb3dubG9hZFN0YXRlKCk6IFByb21pc2U8UmVtb3RlU3RhdGU+IHtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuXHRcdFx0YCR7dGhpcy5zZXR0aW5ncy5zZXJ2ZXJVcmx9L3YxLyR7dGhpcy5zZXR0aW5ncy52YXVsdElkfS9zdGF0ZWAsXG5cdFx0XHR7XG5cdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHQnQWNjZXB0LUVuY29kaW5nJzogJ2d6aXAnLFxuXHRcdFx0XHRcdCdYLUFQSS1LZXknOiB0aGlzLnNldHRpbmdzLmFwaUtleSxcblx0XHRcdFx0XHQnQ29udGVudC1FbmNvZGluZyc6ICdnemlwJyxcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdCk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYERvd25sb2FkIGZhaWxlZDogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKCkudGhlbigoZGF0YSkgPT4ge1xuXHRcdFx0Y29uc29sZS5kZWJ1ZyhkYXRhKTtcblx0XHRcdHJldHVybiBkYXRhLnN0YXRlO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBkb3dubG9hZEZpbGVzKGZpbGVzOiBzdHJpbmdbXSk6IFByb21pc2U8RmlsZUNvbnRlbnRbXT4ge1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5zZXR0aW5ncy5zZXJ2ZXJVcmx9L3YxLyR7dGhpcy5zZXR0aW5ncy52YXVsdElkfS9kb3dubG9hZEZpbGVzYCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdBY2NlcHQtRW5jb2RpbmcnOiAnZ3ppcCcsXG5cdFx0XHRcdCdDb250ZW50LUVuY29kaW5nJzogJ2d6aXAnLFxuXHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHQnWC1BUEktS2V5JzogdGhpcy5zZXR0aW5ncy5hcGlLZXlcblx0XHRcdH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7IGZpbGVzIH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYERvd25sb2FkIGZhaWxlZDogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKCkudGhlbigoZGF0YSkgPT4ge1xuXHRcdFx0Y29uc29sZS5kZWJ1ZyhkYXRhKTtcblx0XHRcdHJldHVybiBkYXRhLmZpbGVzO1xuXHRcdH0pO1xuXHR9XG5cblx0YXN5bmMgZ2V0QWxsRmlsZXNGcm9tU2VydmVyKCk6IFByb21pc2U8c3RyaW5nW10+IHtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuXHRcdFx0YCR7dGhpcy5zZXR0aW5ncy5zZXJ2ZXJVcmx9L3YxLyR7dGhpcy5zZXR0aW5ncy52YXVsdElkfS9hbGxGaWxlc2AsXG5cdFx0XHR7XG5cdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHQnQWNjZXB0LUVuY29kaW5nJzogJ2d6aXAnLFxuXHRcdFx0XHRcdCdDb250ZW50LUVuY29kaW5nJzogJ2d6aXAnLFxuXHRcdFx0XHRcdCdYLUFQSS1LZXknOiB0aGlzLnNldHRpbmdzLmFwaUtleVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGdldCBmaWxlczogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdH1cblxuXHRhc3luYyBnZXRGaWxlSGlzdG9yeShmaWxlSWQ6IHN0cmluZyk6IFByb21pc2U8SGlzdG9yeUVudHJ5W10+IHtcblx0XHRjb25zdCBlbmNvZGVkRmlsZUlkID0gZW5jb2RlVVJJQ29tcG9uZW50KGZpbGVJZCk7XG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcblx0XHRcdGAke3RoaXMuc2V0dGluZ3Muc2VydmVyVXJsfS92MS8ke3RoaXMuc2V0dGluZ3MudmF1bHRJZH0vZmlsZUhpc3RvcnkvJHtlbmNvZGVkRmlsZUlkfWAsXG5cdFx0XHR7XG5cdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHQnQWNjZXB0LUVuY29kaW5nJzogJ2d6aXAnLFxuXHRcdFx0XHRcdCdDb250ZW50LUVuY29kaW5nJzogJ2d6aXAnLFxuXHRcdFx0XHRcdCdYLUFQSS1LZXknOiB0aGlzLnNldHRpbmdzLmFwaUtleVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGdldCBmaWxlIGhpc3Rvcnk6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHR9XG59XG5cblxuY2xhc3MgU2ltcGxlU3luY1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcblx0cGx1Z2luOiBTaW1wbGVTeW5jUGx1Z2luO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFNpbXBsZVN5bmNQbHVnaW4pIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cblxuXHRkaXNwbGF5KCk6IHZvaWQge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnU2VydmVyIFVSTCcpXG5cdFx0XHQuc2V0RGVzYygnVGhlIFVSTCBvZiB0aGUgc3luYyBzZXJ2ZXInKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignRW50ZXIgc2VydmVyIFVSTCcpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXJ2ZXJVcmwpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXJ2ZXJVcmwgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnQVBJIEtleScpXG5cdFx0XHQuc2V0RGVzYygnVGhlIEFQSSBrZXkgZm9yIGF1dGhlbnRpY2F0aW9uJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIEFQSSBrZXknKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYXBpS2V5KVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYXBpS2V5ID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ1N5bmMgSW50ZXJ2YWwnKVxuXHRcdFx0LnNldERlc2MoJ1RoZSBpbnRlcnZhbCAoaW4gc2Vjb25kcykgYXQgd2hpY2ggdG8gc3luYycpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdFbnRlciBzeW5jIGludGVydmFsJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnN5bmNJbnRlcnZhbC50b1N0cmluZygpKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3Muc3luY0ludGVydmFsID0gcGFyc2VJbnQodmFsdWUpO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdQYXVzZSBTeW5jJylcblx0XHRcdC5zZXREZXNjKCdQYXVzZSB0aGUgc3luYyBwcm9jZXNzJylcblx0XHRcdC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuXHRcdFx0XHQuc2V0QnV0dG9uVGV4dCgnUGF1c2UnKVxuXHRcdFx0XHQuc2V0Q3RhKClcblx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnN5bmNQYXVzZWQgPSB0cnVlO1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UoJ1N5bmMgcGF1c2VkJyk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ1Jlc3VtZSBTeW5jJylcblx0XHRcdC5zZXREZXNjKCdSZXN1bWUgdGhlIHN5bmMgcHJvY2VzcycpXG5cdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cblx0XHRcdFx0LnNldEJ1dHRvblRleHQoJ1Jlc3VtZScpXG5cdFx0XHRcdC5zZXRDdGEoKVxuXHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc3luY1BhdXNlZCA9IGZhbHNlO1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UoJ1N5bmMgcmVzdW1lZCcpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdGb3JjZSBSZXN5bmMnKVxuXHRcdFx0LnNldERlc2MoJ1B1c2ggbG9jYWwgc3RhdGUgdG8gdGhlIHJlbW90ZSBzZXJ2ZXInKVxuXHRcdFx0LmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG5cdFx0XHRcdC5zZXRCdXR0b25UZXh0KCdSZXN5bmMnKVxuXHRcdFx0XHQuc2V0Q3RhKClcblx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnJlc3luYygpO1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UoJ1Jlc3luYyBpbml0aWF0ZWQnKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnVmF1bHQgSUQnKVxuXHRcdFx0LnNldERlc2MoJ1RoZSBJRCBvZiB0aGUgdmF1bHQgdG8gc3luYycpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdFbnRlciB2YXVsdCBJRCcpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy52YXVsdElkKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MudmF1bHRJZCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdGdWxsIFJlaGFzaCBJbnRlcnZhbCcpXG5cdFx0XHQuc2V0RGVzYygnSG93IG9mdGVuIChpbiBtaW51dGVzKSB0byBwZXJmb3JtIGEgZnVsbCByZWhhc2ggb2YgYWxsIGZpbGVzJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIGZ1bGwgcmVoYXNoIGludGVydmFsJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZ1bGxSZWhhc2hJbnRlcnZhbC50b1N0cmluZygpKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgaW50ZXJ2YWwgPSBwYXJzZUludCh2YWx1ZSk7XG5cdFx0XHRcdFx0aWYgKCFpc05hTihpbnRlcnZhbCkgJiYgaW50ZXJ2YWwgPiAwKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5mdWxsUmVoYXNoSW50ZXJ2YWwgPSBpbnRlcnZhbDtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSkpO1xuXHR9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHNCQUF3SDtBQTJCakgsSUFBTSxtQkFBTixjQUErQixrQ0FBMEI7QUFBQSxFQUkvRCxZQUFZLEtBQVUsUUFBMEI7QUFDL0MsVUFBTSxHQUFHO0FBSFYsaUJBQWtCLENBQUM7QUFJbEIsU0FBSyxTQUFTO0FBQ2QsU0FBSyxlQUFlLCtCQUErQjtBQUNuRCxTQUFLLFVBQVU7QUFBQSxFQUNoQjtBQUFBLEVBRUEsTUFBTSxZQUFZO0FBQ2pCLFFBQUk7QUFDSCxXQUFLLFFBQVEsTUFBTSxLQUFLLE9BQU8sc0JBQXNCO0FBQ3JELFdBQUssZ0JBQWdCO0FBQUEsUUFDcEIsRUFBRSxTQUFTLGdCQUFNLFNBQVMsY0FBYztBQUFBLFFBQ3hDLEVBQUUsU0FBUyxVQUFLLFNBQVMsWUFBWTtBQUFBLFFBQ3JDLEVBQUUsU0FBUyxPQUFPLFNBQVMsYUFBYTtBQUFBLE1BQ3pDLENBQUM7QUFBQSxJQUNG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QUFBQSxJQUNoQyxDQUFDLENBQUM7QUFFSixRQUFJLHdCQUFRLFdBQVcsRUFDckIsUUFBUSxZQUFZLEVBQ3BCLFFBQVEsd0JBQXdCLEVBQ2hDLFVBQVUsWUFBVSxPQUNuQixjQUFjLE9BQU8sRUFDckIsT0FBTyxFQUNQLFFBQVEsWUFBWTtBQUNwQixXQUFLLE9BQU8sYUFBYTtBQUN6QixVQUFJLHVCQUFPLGFBQWE7QUFBQSxJQUN6QixDQUFDLENBQUM7QUFFSixRQUFJLHdCQUFRLFdBQVcsRUFDckIsUUFBUSxhQUFhLEVBQ3JCLFFBQVEseUJBQXlCLEVBQ2pDLFVBQVUsWUFBVSxPQUNuQixjQUFjLFFBQVEsRUFDdEIsT0FBTyxFQUNQLFFBQVEsWUFBWTtBQUNwQixXQUFLLE9BQU8sYUFBYTtBQUN6QixVQUFJLHVCQUFPLGNBQWM7QUFBQSxJQUMxQixDQUFDLENBQUM7QUFFSixRQUFJLHdCQUFRLFdBQVcsRUFDckIsUUFBUSxjQUFjLEVBQ3RCLFFBQVEsdUNBQXVDLEVBQy9DLFVBQVUsWUFBVSxPQUNuQixjQUFjLFFBQVEsRUFDdEIsT0FBTyxFQUNQLFFBQVEsWUFBWTtBQUNwQixZQUFNLEtBQUssT0FBTyxPQUFPO0FBQ3pCLFVBQUksdUJBQU8sa0JBQWtCO0FBQUEsSUFDOUIsQ0FBQyxDQUFDO0FBRUosUUFBSSx3QkFBUSxXQUFXLEVBQ3JCLFFBQVEsVUFBVSxFQUNsQixRQUFRLDZCQUE2QixFQUNyQyxRQUFRLFVBQVEsS0FDZixlQUFlLGdCQUFnQixFQUMvQixTQUFTLEtBQUssT0FBTyxTQUFTLE9BQU8sRUFDckMsU0FBUyxPQUFPLFVBQVU7QUFDMUIsV0FBSyxPQUFPLFNBQVMsVUFBVTtBQUMvQixZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDaEMsQ0FBQyxDQUFDO0FBRUosUUFBSSx3QkFBUSxXQUFXLEVBQ3JCLFFBQVEsc0JBQXNCLEVBQzlCLFFBQVEsOERBQThELEVBQ3RFLFFBQVEsVUFBUSxLQUNmLGVBQWUsNEJBQTRCLEVBQzNDLFNBQVMsS0FBSyxPQUFPLFNBQVMsbUJBQW1CLFNBQVMsQ0FBQyxFQUMzRCxTQUFTLE9BQU8sVUFBVTtBQUMxQixZQUFNLFdBQVcsU0FBUyxLQUFLO0FBQy9CLFVBQUksQ0FBQyxNQUFNLFFBQVEsS0FBSyxXQUFXLEdBQUc7QUFDckMsYUFBSyxPQUFPLFNBQVMscUJBQXFCO0FBQzFDLGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxNQUNoQztBQUFBLElBQ0QsQ0FBQyxDQUFDO0FBQUEsRUFDTDtBQUNEOyIsCiAgIm5hbWVzIjogWyJjb250ZW50IiwgImZpbGUiLCAicmVtb3RlRmlsZXMiXQp9Cg==
